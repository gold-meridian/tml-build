<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

    <!-- Install the requested tML version before any processing occurs that
         tries to use it. -->
    <UsingTask TaskName="TmlVersionTask" AssemblyFile="Tomat.TML.Build.MSBuild.dll"/>
    <Target Name="ProcessTmlVersionBeforeReferencesAreResolved" BeforeTargets="ResolveReferences">
        <TmlVersionTask Version="$(TmlVersion)" TargetsPath="$(TmlTargetsPath)"/>
    </Target>

    <UsingTask TaskName="PackageModTask" AssemblyFile="Tomat.TML.Build.MSBuild.dll"/>
    <Target Name="PackageMod" AfterTargets="Build">
        <!-- all of these refs are TODO -->
        <PackageModTask PackageReferences="@(PackageReferences)"
                        ProjectReferences="@(_ResolvedProjectReferencePaths)"
                        ReferencePaths="@(ModReference)"
                        ModReferences="@(ReferencePath)"
                        ProjectDirectory="$(MSBuildProjectDirectory)"
                        OutputPath="$(OutputPath)"
                        AssemblyName="$(AssemblyName)"
                        TmlVersion="$(TmlVersion)"
                        TmodOutputPath="$(TmodOutputPath)"
                        BuildFilePath="$(ModManifestPath)"
                        DescriptionFilePath="$(ModDescriptionPath)"/>
    </Target>

</Project>